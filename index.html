<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Bluesky Widget: Profile Card Generator for Bluesky Profiles ðŸ¦‹">
  <meta property="og:image:secure_url" itemprop="image"
    content="https://res.cloudinary.com/saurabhdaware/image/upload/v1731009580/saurabh2025/bsky-widget-og.png">
  <meta property="og:image" itemprop="image"
    content="https://res.cloudinary.com/saurabhdaware/image/upload/v1731009580/saurabh2025/bsky-widget-og.png">
  <meta property="og:image:width" content="1280" />
  <meta property="og:image:height" content="640" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:creator" content="@saurabhdawaree">


  <title>Bluesky Widget: Profile Card Generator for Bluesky Profiles ðŸ¦‹</title>
  <meta name="description" content="Bluesky Widget: Cute Bluesky Profile Cards for your websites!!" />
  <link rel="icon" type="image/png" sizes="32x32" href="/bsky-icon-32.png">
  <link rel="stylesheet" href="./playground.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
</head>

<body>
  <main class="page-container">
    <div class="sidebar">
      <div class="title">
        <h1>
          <span><img width="42px" src="./component/Bluesky-logo.svg" alt="Bluesky Logo" /></span>
          <span>Bluesky Widget</span>
        </h1>
      </div>
      <section class="form-wrapper">
        <form id="generator-form" class="form-container">
          <div class="input-container">
            <label for="handle">Handle</label>
            <input name="handle" placeholder="saurabhd.bsky.social" value="saurabhd.bsky.social" type="text"
              id="handle" />
          </div>

          <div style="display: flex;gap: 24px;">
            <div class="input-container checkbox-container">
              <label for="show-description">Show Description</label>
              <label class="switch">
                <input name="description" id="show-description" checked type="checkbox">
                <span class="slider"></span>
              </label>
            </div>
            <div class="input-container checkbox-container">
              <label for="show-banner">Show Banner</label>
              <label class="switch">
                <input name="banner" id="show-banner" checked type="checkbox">
                <span class="slider"></span>
              </label>
            </div>
          </div>
          <button class="button generate-button" type="submit">Generate</button>
        </form>
      </section>
    </div>
    <div class="preview-code-container">
      <section class="preview-code">
        <div class="preview">
          <bsky-widget data-handle="saurabhd.bsky.social" data-show-description="false"
            data-show-banner="false"></bsky-widget>
        </div>
        <div class="code-section">
          <div class="code-output">
            <pre><code class="language-html"></code></pre>
            <button class="copy-button">Copy</button>
          </div>
        </div>
      </section>

      <section class="docs-container share-container">
        <div style="text-align: right;">
          <a id="bsky-share-button" class="bsky-share-button button" target="_blank" rel="noreferrer noopener"
            href="https://bsky.app/intent/compose?text=Check out the Bluesky Widget Card at https://bsky-widget.saurabhdaware.in/">
            <span><img width="20px" src="./component/Bluesky-logo.svg" alt="Bluesky Logo" /></span>
            <span>Share with Bluesky Frens ðŸ¤—</span>
          </a>
        </div>
      </section>

      <section class="docs-container">
        <h2>Examples</h2>
        <h3>In Vanilla Project</h3>
        <div class="sb-embed" id="stackblitz-vanilla-project"></div>

        <h3>In Frameworks</h3>
        <div class="sb-embed" id="stackblitz-framework-project"></div>
      </section>

      <footer class="docs-container">
        Built with <a target="_blank" href="https://vite.dev">Vite</a>, <a target="_blank"
          href="https://abelljs.org">Abell</a>, and <a href="https://youtu.be/dBUxfFoQpuo?si=RhXnApKmRYADA8YX&t=36"
          target="_blank">Love</a> by <a href="https://saurabhd.bsky.social" target="_blank">@saurabhd.bsky.social</a>
      </footer>
    </div>
  </main>


  <a href="https://github.com/saurabhdaware/bsky-widget" target="_blank" class="github-corner"
    aria-label="View source on GitHub">
    <svg width="80" height="80" viewBox="0 0 250 250"
      style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
      <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
      <path
        d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
        fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
      <path
        d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
        fill="currentColor" class="octo-body"></path>
    </svg>
  </a>
  <script src="./component/card.js" type="module"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://unpkg.com/@stackblitz/sdk@1/bundles/sdk.umd.js"></script>
  <script>
    const generateButton = document.querySelector("button.generate-button");
    const handle = document.querySelector("input#handle");
    const showDescriptionEl = document.querySelector("input#show-description");
    const showBannerEl = document.querySelector("input#show-banner");
    const code = document.querySelector("code");

    const searchParams = new URLSearchParams(window.location.search);
    const handleParam = searchParams.get('handle');
    if (handleParam) {
      handle.value = handleParam;
    }

    const setShare = (handle) => {
      const shareText = encodeURIComponent(`I just created my Bluesky Widget Card ðŸ¦‹ <br/><br/>Check it out and create yours at-<br/><br/> https://bsky-widget.saurabhdaware.in/?handle=${handle}`);
      document.querySelector('#bsky-share-button').href = `https://bsky.app/intent/compose?text=${shareText}`;
    }

    const appendHandleParam = (handleValue) => {
      // Get the current URL
      const url = new URL(window.location.href);

      // Set or update the 'handle' parameter
      url.searchParams.set('handle', handleValue);

      // Update the URL in the address bar without reloading the page
      window.history.pushState({}, '', url);
    }

    function dedent(text) {
      const lines = text.split("\n");

      const indentLevel = Math.min(
        ...lines
          .filter((line) => line.trim())
          .map((line) => line.match(/^(\s*)/)[0].length)
      );

      // Remove the common indentation from each line
      return lines
        .map((line) => line.slice(indentLevel)) // Remove leading whitespace
        .join("\n") // Join lines back together
        .trim(); // Trim any leading or trailing whitespace
    }

    const setWidgetPreview = () => {
      const widget = document.querySelector("bsky-widget");
      widget.setAttribute("data-handle", handle.value);
      widget.setAttribute("data-show-banner", showBannerEl.checked);
      widget.setAttribute("data-show-description", showDescriptionEl.checked);

      let additionalProps = '';
      if (!showDescriptionEl.checked) {
        additionalProps += `\n    data-show-description="${showDescriptionEl.checked}"`
      }

      if (!showBannerEl.checked) {
        additionalProps += `\n    data-show-banner="${showBannerEl.checked}"`
      }

      code.innerHTML = dedent(`
  &lt;!-- Paste in your CSS to avoid layout shift --&gt;
  &lt;style&gt;
  bsky-widget {
    min-height: 400px;
    width: 350px;
  }
  &lt;/style&gt;

  &lt;!-- Paste wherever you want to render the card --&gt;
  &lt;bsky-widget 
    data-handle="${handle.value}"${additionalProps}
  &gt;
  &lt;/bsky-widget&gt;
  
  &lt;!-- Paste before end of body --&gt;
  &lt;script 
    src="https://unpkg.com/bsky-widget@~0.0/dist/index.js" 
    type="module"
  &gt;
  &lt;/script&gt;`);
      code.removeAttribute("data-highlighted");
      setShare(handle.value);


      const boundCheckInterval = setInterval(() => {
        console.log(widget.dataset.rendered);
        if (widget.dataset.rendered === 'true') {
          clearInterval(boundCheckInterval);

          setTimeout(() => {
            const widgetBounds = widget.getClientRects()[0];
            const height = Math.round(widgetBounds.height);
            const width = Math.round(widgetBounds.width);
            console.log(widgetBounds, height, width);
            code.innerHTML = code.innerHTML.replace('400px', `${height}px`).replace('350px', `${width}px`);
            code.removeAttribute("data-highlighted");
            hljs.highlightBlock(document.querySelector("code"));
          }, 500);
        }
      }, 100)

      hljs.highlightBlock(document.querySelector("code"));
    };

    const copyCode = () => {
      var copyText = document.querySelector("code");
      const testIp = document.createElement('textarea');
      testIp.style.position = 'fixed';
      testIp.style.top = '-10000px';
      document.body.append(testIp);
      testIp.value = copyText.innerText.replace(/\n/g, '\r\n');
      testIp.select();
      testIp.setSelectionRange(0, 99999)
      document.execCommand("copy");
    }

    document.querySelector('form#generator-form').addEventListener("submit", (e) => {
      e.preventDefault();
      setWidgetPreview();
      appendHandleParam(handle.value);
    });

    document.querySelectorAll('input[type="checkbox"]').forEach((checkbox) => {
      checkbox.addEventListener('change', () => {
        setWidgetPreview();
      })
    })

    handle.addEventListener('blur', () => {
      setWidgetPreview();
      appendHandleParam(handle.value);
    })

    document.querySelector('button.copy-button').addEventListener('click', () => {
      copyCode();
      document.querySelector('button.copy-button').innerText = 'Copied';
      setTimeout(() => {
        document.querySelector('button.copy-button').innerText = 'Copy';
      }, 2000);
    })

    hljs.initHighlightingOnLoad();
    setWidgetPreview();


    window.StackBlitzSDK.embedProjectId(
      'stackblitz-vanilla-project',
      'bsky-widget-vanilla-project',
      {
        forceEmbedLayout: true,
        openFile: 'index.html',
        theme: 'light',
        clickToLoad: true,
        hideExplorer: true,
        hideNavigation: true,
      }
    );

    window.StackBlitzSDK.embedProjectId(
      'stackblitz-framework-project',
      'bsky-widget-vue',
      {
        forceEmbedLayout: true,
        openFile: 'package.json,src/App.vue',
        theme: 'light',
        clickToLoad: true,
        hideExplorer: true,
        hideNavigation: true,
      }
    );

  </script>
</body>

</html>